(function(t){function e(e){for(var r,o,s=e[0],c=e[1],u=e[2],l=0,f=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);p&&p(e);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},i=[];function o(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-2d0c849e":"0b5c8ac7","chunk-2d0e5d9c":"b25754c3","chunk-2d22494f":"35fd6335"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n=a[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=a[t]=[e,r]}));e.push(n[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(t);var u=new Error;i=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",u.name="ChunkLoadError",u.type=r,u.request=i,n[1](u)}a[t]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var p=u;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"2a89":function(t,e,n){"use strict";n("c02e")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=n("2f62"),i=n("c14f"),o=n("1da1"),s=(n("a15b"),n("e9c4"),n("b64b"),n("9b0f")),c=n.n(s),u=n("a32b"),l=n.n(u),p=new CSInterface,f=l.a.join(p.getSystemPath("userData"),"Adobe","CEP","Extensions","EZImport","config.json"),d=l.a.join(p.getSystemPath("extension"),"config.default.json");function m(){return h.apply(this,arguments)}function h(){return h=Object(o["a"])(Object(i["a"])().m((function t(){var e,n;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,c.a.promises.readFile(f,"utf-8");case 1:return e=t.v,t.a(2,JSON.parse(e));case 2:return t.p=2,t.v,t.n=3,c.a.promises.readFile(d,"utf-8");case 3:return n=t.v,t.a(2,JSON.parse(n))}}),t,null,[[0,2]])}))),h.apply(this,arguments)}function g(t){return b.apply(this,arguments)}function b(){return b=Object(o["a"])(Object(i["a"])().m((function t(e){var n;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,c.a.promises.mkdir(l.a.dirname(f),{recursive:!0});case 1:return t.n=2,c.a.promises.writeFile(f,JSON.stringify(e,null,2));case 2:t.n=4;break;case 3:t.p=3,n=t.v,console.error("Error saving config:",n);case 4:return t.a(2)}}),t,null,[[0,3]])}))),b.apply(this,arguments)}var v={namespaced:!0,state:function(){return{pathDirectory:null,libraryType:null,locale:"en"}},mutations:{setPathDirectory:function(t,e){t.pathDirectory=e},setLibraryType:function(t,e){t.libraryType=e},setLocale:function(t,e){t.locale=e}},actions:{initConfig:function(t){return Object(o["a"])(Object(i["a"])().m((function e(){var n,r,a,o;return Object(i["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return n=t.commit,r=t.dispatch,e.p=1,e.n=2,m();case 2:if(a=e.v,a.pathDirectory&&n("setPathDirectory",a.pathDirectory),a.locale&&n("setLocale",a.locale),!a.pathDirectory){e.n=5;break}return e.n=3,r("manifest/ensure",a.pathDirectory,{root:!0});case 3:return e.n=4,r("manifest/rebuildAll",a.pathDirectory,{root:!0});case 4:return e.n=5,r("categories/fetchCategories",null,{root:!0});case 5:e.n=7;break;case 6:e.p=6,o=e.v,r("notifications/error",{text:"Ошибка загрузки конфига: ".concat(o.message)},{root:!0});case 7:return e.a(2)}}),e,null,[[1,6]])})))()},persistConfig:function(t){return Object(o["a"])(Object(i["a"])().m((function e(){var n,r,a;return Object(i["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return n=t.state,r=t.dispatch,e.p=1,e.n=2,g({pathDirectory:n.pathDirectory,locale:n.locale});case 2:e.n=4;break;case 3:e.p=3,a=e.v,r("notifications/error",{text:"Ошибка сохранения конфига: ".concat(a.message)},{root:!0});case 4:return e.a(2)}}),e,null,[[1,3]])})))()},updatePathDirectory:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a;return Object(i["a"])().w((function(n){while(1)switch(n.n){case 0:return r=t.commit,a=t.dispatch,r("setPathDirectory",e),n.n=1,a("persistConfig");case 1:return n.n=2,a("manifest/rebuildAll",e,{root:!0});case 2:return n.a(2)}}),n)})))()},updateLocale:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a;return Object(i["a"])().w((function(n){while(1)switch(n.n){case 0:return r=t.commit,a=t.dispatch,r("setLocale",e),n.n=1,a("persistConfig");case 1:return n.a(2)}}),n)})))()}}},y=n("5530"),_=n("b85c"),w=n("3835"),j=(n("d81d"),n("14d9"),n("e9f5"),n("ab43"),n("4fad"),n("d3b7"),n("ac1f"),n("841c"),n("4300")),O={namespaced:!0,state:function(){return{query:"",results:[],fuse:null}},mutations:{SET_QUERY:function(t,e){t.query=e},SET_RESULTS:function(t,e){t.results=e},SET_FUSE:function(t,e){t.fuse=e}},actions:{init:function(t){for(var e=t.commit,n=t.rootGetters,r=n["manifest/itemsByCategory"]||{},a=[],i=0,o=Object.entries(r);i<o.length;i++){var s,c=Object(w["a"])(o[i],2),u=c[0],l=c[1],p=Object(_["a"])(l);try{for(p.s();!(s=p.n()).done;){var f=s.value;a.push(Object(y["a"])(Object(y["a"])({},f),{},{categoryPath:u}))}}catch(m){p.e(m)}finally{p.f()}}var d=new j["a"](a,{keys:["name","formats"],threshold:.3,includeScore:!0,includeMatches:!0});e("SET_FUSE",d)},run:function(t,e){var n=t.commit,r=t.state;if(n("SET_QUERY",e),e&&r.fuse){var a=r.fuse.search(e).map((function(t){return Object(y["a"])(Object(y["a"])({},t.item),{},{matches:t.matches})}));n("SET_RESULTS",a)}else n("SET_RESULTS",[])}},getters:{query:function(t){return t.query},results:function(t){return t.results}}},C=(n("caad"),n("6062"),n("1e70"),n("79a4"),n("c1a1"),n("8b00"),n("a4e7"),n("1e5a"),n("72c3"),n("2532"),n("3ca3"),n("ddb0"),c.a.promises),k=(new Set([".DS_Store","Thumbs.db"]),{namespaced:!0,actions:{detectLibraryType:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:return r=t.dispatch,n.p=1,n.n=2,C.readdir(e);case 2:if(a=n.v,!a.includes("manifest.json")){n.n=3;break}return n.a(2,"our");case 3:return n.a(2,"new");case 4:return n.p=4,o=n.v,r("notifications/error",{text:"Ошибка при определении папки: ".concat(o.message)},{root:!0}),n.a(2,"error")}}),n,null,[[1,4]])})))()},initLibrary:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a;return Object(i["a"])().w((function(n){while(1)switch(n.n){case 0:return r=t.dispatch,n.n=1,r("detectLibraryType",e);case 1:if(a=n.v,"error"!==a&&"invalid"!==a){n.n=2;break}return"invalid"===a&&r("notifications/error",{text:"Папка содержит файлы/папки без manifest.json. Выберите пустую папку или библиотеку EZImport."},{root:!0}),n.a(2,!1);case 2:return n.n=3,r("config/updateLibraryType",a,{root:!0});case 3:return n.n=4,r("config/updatePathDirectory",e,{root:!0});case 4:return n.n=5,r("categories/fetchCategories",null,{root:!0});case 5:return r("notifications/info",{text:"Библиотека инициализирована"},{root:!0}),n.a(2,!0)}}),n)})))()}}}),x=(n("a732"),{namespaced:!0,state:function(){return{loaders:{}}},getters:{isLoading:function(t){return Object.keys(t.loaders).length>0},isLoadingByKey:function(t){return function(e){return!!t.loaders[e]}},isLoadingByKeys:function(t){return function(e){return e.some((function(e){return!!t.loaders[e]}))}}},mutations:{START:function(t,e){r["a"].set(t.loaders,e,!0)},STOP:function(t,e){r["a"].delete(t.loaders,e)},RESET:function(t){t.loaders={}}},actions:{start:function(t,e){var n=t.commit;n("START",e)},stop:function(t,e){var n=t.commit;n("STOP",e)},reset:function(t){var e=t.commit;e("RESET")}}}),S=(n("4de4"),n("c740"),n("b0c0"),n("d9e2"),n("910d"),n("5319"),n("2ca0"),c.a.promises),E=new Set([".DS_Store","Thumbs.db","desktop.ini"]);function T(t){return $.apply(this,arguments)}function $(){return $=Object(o["a"])(Object(i["a"])().m((function t(e){var n;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,S.readdir(e).catch((function(){return[]}));case 1:return n=t.v,t.a(2,n.filter((function(t){return!!t&&!E.has(t)&&!t.startsWith(".")})))}}),t)}))),$.apply(this,arguments)}function P(t){return L.apply(this,arguments)}function L(){return L=Object(o["a"])(Object(i["a"])().m((function t(e){return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,S.lstat(e);case 1:return t.a(2,t.v.isDirectory());case 2:return t.p=2,t.v,t.a(2,!1)}}),t,null,[[0,2]])}))),L.apply(this,arguments)}function D(t,e){return e.map((function(e){return{name:e,path:l.a.join(t,e),format:l.a.extname(e).toLowerCase()}}))}function M(t){return A.apply(this,arguments)}function A(){return A=Object(o["a"])(Object(i["a"])().m((function t(e){var n;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,S.readdir(e,{withFileTypes:!0});case 1:return n=t.v,t.a(2,n.filter((function(t){return t.isDirectory()&&!E.has(t.name)&&!t.name.startsWith(".")&&"manifest.json"!==t.name})).map((function(t){return t.name})));case 2:return t.p=2,t.v,t.a(2,[])}}),t,null,[[0,2]])}))),A.apply(this,arguments)}n("7db0"),n("4e82"),n("f665");var B=[".aep",".mov"],F=[".gif",".png",".jpg",".jpeg",".webp"],N=function(t,e){c.a.writeFileSync(t+".tmp",e,"utf8"),c.a.renameSync(t+".tmp",t)},q=function(t,e){var n,r=Object(_["a"])(e);try{var a,i=function(){var e=n.value,r=t.find((function(t){return t.format===e}));if(r)return{v:r.path}};for(r.s();!(n=r.n()).done;)if(a=i(),a)return a.v}catch(o){r.e(o)}finally{r.f()}return null},I=function(t){return t.sort((function(t,e){return t.name.localeCompare(e.name)}))},z=function(t){return l.a.normalize(t)};function R(t){return U.apply(this,arguments)}function U(){return U=Object(o["a"])(Object(i["a"])().m((function t(e){var n,r,a,o,s,c,u,p,f,d;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.n=1,M(e).catch((function(){return[]}));case 1:n=t.v,r=[],a=Object(_["a"])(n),t.p=2,a.s();case 3:if((o=a.n()).done){t.n=7;break}return s=o.value,c=z(l.a.join(e,s)),t.n=4,T(c).catch((function(){return[]}));case 4:if(u=t.v,p=D(c,u),f=p.filter((function(t){return B.includes(t.format)})),f.length){t.n=5;break}return t.a(3,6);case 5:r.push({name:s,path:c,files:f.map((function(t){return t.path})),formats:f.map((function(t){return t.format})),previewPath:q(p,F)});case 6:t.n=3;break;case 7:t.n=9;break;case 8:t.p=8,d=t.v,a.e(d);case 9:return t.p=9,a.f(),t.f(9);case 10:return t.a(2,r)}}),t,null,[[2,8,9,10]])}))),U.apply(this,arguments)}function J(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{version:1,updated:(null===e||void 0===e?void 0:e.updated)||(new Date).toISOString(),rootDir:t,categories:Array.isArray(null===e||void 0===e?void 0:e.categories)?e.categories:[],itemsByCategory:(null===e||void 0===e?void 0:e.itemsByCategory)||{}}}var V="manifest.json",H={namespaced:!0,state:function(){return{busy:!1,path:null,data:null}},mutations:{SET_PATH:function(t,e){return t.path=e},SET_DATA:function(t,e){return t.data=e},SET_BUSY:function(t,e){return t.busy=!!e}},actions:{ensure:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,u,p,f;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.commit,a=t.dispatch,n.p=1,p=!e,p){n.n=3;break}return n.n=2,P(e);case 2:p=!n.v;case 3:if(!p){n.n=4;break}throw new Error("некорректный корень");case 4:o=z(l.a.join(e,V)),r("SET_PATH",o),s=null;try{s=JSON.parse(c.a.readFileSync(o,"utf8"))}catch(i){}return u=J(e,s),s||N(o,JSON.stringify(u,null,2)),r("SET_DATA",u),n.a(2,u);case 5:return n.p=5,f=n.v,a("notifications/error",{text:"Manifest ensure: ".concat(f.message)},{root:!0}),n.a(2,null)}}),n,null,[[1,5]])})))()},rebuildAll:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,c,u,p,f,d,m,h,g,b,v,y;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.commit,a=t.dispatch,o=t.state,!o.busy){n.n=1;break}return n.a(2,o.data);case 1:return r("SET_BUSY",!0),n.p=2,n.n=3,M(e);case 3:s=n.v,c={},u=[],p=Object(_["a"])(s),n.p=4,p.s();case 5:if((f=p.n()).done){n.n=8;break}return d=f.value,m=z(l.a.join(e,d)),n.n=6,R(m);case 6:h=n.v,c[m]=h,u.push({name:d,path:m,count:h.length});case 7:n.n=5;break;case 8:n.n=10;break;case 9:n.p=9,v=n.v,p.e(v);case 10:return n.p=10,p.f(),n.f(10);case 11:return g={version:1,updated:(new Date).toISOString(),rootDir:e,categories:I(u),itemsByCategory:c},b=o.path||z(l.a.join(e,V)),N(b,JSON.stringify(g,null,2)),r("SET_PATH",b),r("SET_DATA",g),a("notifications/info",{text:"Глобальный манифест пересобран"},{root:!0}),n.a(2,g);case 12:return n.p=12,y=n.v,a("notifications/error",{text:"Manifest rebuild: ".concat(y.message)},{root:!0}),n.a(2,null);case 13:return n.p=13,r("SET_BUSY",!1),n.f(13);case 14:return n.a(2)}}),n,null,[[4,9,10,11],[2,12,13,14]])})))()},upsertCategory:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,c,u,p,f,d,m,h,g;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.state,a=t.commit,o=t.dispatch,s=e.name,c=e.categoryPath,n.p=1,r.data&&r.path){n.n=2;break}return u=z(l.a.dirname(c)),n.n=2,o("ensure",u);case 2:return p=z(c),n.n=3,R(p);case 3:return f=n.v,d=Object(y["a"])({},r.data||J(l.a.dirname(p))),d.itemsByCategory[p]=f,m={name:s||l.a.basename(p),path:p,count:f.length},h=d.categories.findIndex((function(t){return z(t.path)===p})),h>=0?d.categories[h]=m:d.categories.push(m),d.categories=I(d.categories),d.updated=(new Date).toISOString(),N(r.path,JSON.stringify(d,null,2)),a("SET_DATA",d),o("notifications/info",{text:"Манифест обновлён: ".concat(m.name),silent:!0},{root:!0}),n.a(2,f);case 4:return n.p=4,g=n.v,o("notifications/error",{text:"Manifest upsert: ".concat(g.message)},{root:!0}),n.a(2,[])}}),n,null,[[1,4]])})))()},upsertComposition:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,c,u,p,f,d,m,h,g;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.state,a=t.commit,o=t.dispatch,s=e.categoryPath,c=e.composition,n.p=1,r.data&&r.path){n.n=2;break}return u=z(l.a.dirname(s)),n.n=2,o("ensure",u);case 2:return p=z(s),f=Object(y["a"])({},r.data||J(l.a.dirname(p))),f.itemsByCategory[p]||(f.itemsByCategory[p]=[]),d=f.itemsByCategory[p].findIndex((function(t){return z(t.path)===z(c.path)})),d>=0?f.itemsByCategory[p][d]=c:f.itemsByCategory[p].push(c),m={name:l.a.basename(p),path:p,count:f.itemsByCategory[p].length},h=f.categories.findIndex((function(t){return z(t.path)===p})),h>=0?f.categories[h]=m:f.categories.push(m),f.categories=I(f.categories),f.updated=(new Date).toISOString(),N(r.path,JSON.stringify(f,null,2)),a("SET_DATA",f),o("notifications/info",{text:"Композиция обновлена: ".concat(c.name),silent:!0},{root:!0}),n.a(2,c);case 3:return n.p=3,g=n.v,o("notifications/error",{text:"Manifest upsertComposition: ".concat(g.message)},{root:!0}),n.a(2,null)}}),n,null,[[1,3]])})))()},removeCategory:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,c,u,l;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.state,a=t.commit,o=t.dispatch,n.p=1,r.data&&r.path){n.n=2;break}return n.a(2,!1);case 2:return c=Object(y["a"])({},r.data),u=z(e),null===(s=c.itemsByCategory)||void 0===s||delete s[u],c.categories=(c.categories||[]).filter((function(t){return z(t.path)!==u})),c.updated=(new Date).toISOString(),N(r.path,JSON.stringify(c,null,2)),a("SET_DATA",c),o("notifications/warn",{text:"Категория удалена из манифеста"},{root:!0}),n.a(2,!0);case 3:return n.p=3,l=n.v,o("notifications/error",{text:"Manifest remove: ".concat(l.message)},{root:!0}),n.a(2,!1)}}),n,null,[[1,3]])})))()}},getters:{manifest:function(t){return t.data},categories:function(t){var e;return(null===(e=t.data)||void 0===e?void 0:e.categories)||[]},itemsByCategory:function(t){var e;return(null===(e=t.data)||void 0===e?void 0:e.itemsByCategory)||{}},items:function(t){return function(e){var n;return(null===(n=t.data)||void 0===n||null===(n=n.itemsByCategory)||void 0===n?void 0:n[z(e)])||[]}}}},K=(n("498a"),n("99af"),n("00b4"),/[<>:"/\\|?*\x00-\x1F]/g),Y=/^[.\s]+|[.\s]+$/g,Z=/^(con|prn|aux|nul|com[1-9]|lpt[1-9])$/i;function G(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240,r="",a=0,i=Object(_["a"])(t);try{for(i.s();!(e=i.n()).done;){var o=e.value,s=Buffer.byteLength(o,"utf8");if(a+s>n)break;r+=o,a+=s}}catch(c){i.e(c)}finally{i.f()}return r}function Q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=String(t||"").normalize("NFKC").replace(K,e).replace(/\s+/g," ").replace(/-{2,}/g,"-").trim().replace(Y,"");return("."===n||".."===n||Z.test(n))&&(n="".concat(n,"-item")),n=G(n,240),n||(n="untitled"),n}function W(t,e){return X.apply(this,arguments)}function X(){return X=Object(o["a"])(Object(i["a"])().m((function t(e,n){var r,a,o,s;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:r=Q(n),a=r,o=2,s=l.a.join(e,a);case 1:return t.n=2,c.a.promises.stat(s).then((function(){return!0})).catch((function(){return!1}));case 2:if(!t.v){t.n=3;break}a="".concat(r," (").concat(o++,")"),s=l.a.join(e,a),t.n=1;break;case 3:return t.a(2,{dirPath:s,dirName:a,safeBaseName:r})}}),t)}))),X.apply(this,arguments)}var tt={namespaced:!0,state:function(){return{categories:[],searchField:"",currentCategory:null}},mutations:{setCategories:function(t,e){t.categories=e,e.length||(t.currentCategory=null)},setCurrentCategory:function(t,e){t.currentCategory=e},setSearchField:function(t,e){t.searchField=e}},actions:{fetchCategories:function(t){return Object(o["a"])(Object(i["a"])().m((function e(){var n,r,a,s,c,u,p,f,d,m;return Object(i["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:if(n=t.commit,r=t.dispatch,a=t.rootState,s=t.state,c=a.config.pathDirectory,c){e.n=1;break}return r("notifications/error",{text:"Папка не выбрана"},{root:!0}),e.a(2);case 1:return e.p=1,e.n=2,M(c);case 2:return u=e.v,e.n=3,Promise.all(u.map(function(){var t=Object(o["a"])(Object(i["a"])().m((function t(e){var n,a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return n=l.a.join(c,e),t.n=1,r("compositions/fetchCompositions",n,{root:!0});case 1:return a=t.v,t.a(2,{name:e,path:n,compositions:a})}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:p=e.v,p.sort((function(t,e){return t.name.localeCompare(e.name)})),n("setCategories",p),s.currentCategory?(f=s.currentCategory,d=p.find((function(t){return t.path===f.path||t.name===f.name})),n("setCurrentCategory",d||null)):p.length&&n("setCurrentCategory",p[0]),r("notifications/info",{text:"Категории обновлены",silent:!0},{root:!0}),e.n=5;break;case 4:e.p=4,m=e.v,r("notifications/error",{text:"Ошибка при чтении папки: ".concat(m.message)},{root:!0});case 5:return e.a(2)}}),e,null,[[1,4]])})))()},createCategory:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,u,l,p,f,d;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.rootState,a=t.dispatch,o=r.config.pathDirectory,o){n.n=1;break}return a("notifications/error",{text:"Папка не выбрана"},{root:!0}),n.a(2);case 1:if(n.p=1,s=(e||"").trim(),s){n.n=2;break}return a("notifications/warn",{text:"Укажите имя категории"},{root:!0}),n.a(2);case 2:if(u=Q(s),u){n.n=3;break}return a("notifications/error",{text:"Недопустимое имя категории"},{root:!0}),n.a(2);case 3:return n.n=4,W(o,u);case 4:return l=n.v,p=l.dirPath,f=l.dirName,n.n=5,c.a.promises.mkdir(p,{recursive:!0});case 5:return n.n=6,a("manifest/upsertCategory",{name:f,categoryPath:p},{root:!0});case 6:return n.n=7,a("categories/fetchCategories",null,{root:!0});case 7:a("notifications/info",{text:'Категория "'.concat(f,'" создана')},{root:!0}),n.n=9;break;case 8:n.p=8,d=n.v,a("notifications/error",{text:"Ошибка при создании категории: ".concat(d.message)},{root:!0});case 9:return n.a(2)}}),n,null,[[1,8]])})))()}},getters:{getFilteredCategories:function(t){if(!t.searchField)return t.categories;var e=t.searchField.toLowerCase();return t.categories.filter((function(t){return t.name.toLowerCase().includes(e)}))},getCategories:function(t){return t.categories},getCurrentCategory:function(t){return t.currentCategory}}},et=(n("a9e3"),n("ebe6")),nt=[".aep",".mov"],rt=[".gif",".png",".jpg",".jpeg",".webp"];function at(t){for(var e,n=function(){var e=a[r],n=t.find((function(t){return t.format===e}));if(n)return{v:n.path}},r=0,a=rt;r<a.length;r++)if(e=n(),e)return e.v;return null}var it={namespaced:!0,actions:{fetchCompositions:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,c,u,p,f,d,m,h,g,b,v,y;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:return r=t.dispatch,n.p=1,n.n=2,M(e);case 2:a=n.v,o=[],s=Object(_["a"])(a),n.p=3,s.s();case 4:if((c=s.n()).done){n.n=8;break}return u=c.value,p=l.a.join(e,u),n.n=5,T(p);case 5:if(f=n.v,d=D(p,f),m=d.filter((function(t){return nt.includes(t.format)})),m.length){n.n=6;break}return n.a(3,7);case 6:h=m.map((function(t){return t.format})),g=m.map((function(t){return t.path})),b=at(d),o.push({name:u,path:p,files:d,formats:h,filesPaths:g,previewPath:b});case 7:n.n=4;break;case 8:n.n=10;break;case 9:n.p=9,v=n.v,s.e(v);case 10:return n.p=10,s.f(),n.f(10);case 11:return n.a(2,o);case 12:return n.p=12,y=n.v,r("notifications/error",{text:"Ошибка при чтении композиций: ".concat(y.message)},{root:!0}),n.a(2,[])}}),n,null,[[3,9,10,11],[1,12]])})))()},fetchFiles:function(t,e){return Object(o["a"])(Object(i["a"])().m((function t(){var n;return Object(i["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,P(e);case 1:if(t.v){t.n=2;break}return t.a(2,[]);case 2:return t.n=3,T(e);case 3:return n=t.v,t.a(2,D(e,n));case 4:return t.p=4,t.v,t.a(2,[])}}),t,null,[[0,4]])})))()},saveComposition:function(t,e){return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,u,l,p,f,d,m,h,g,b;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(r=t.dispatch,a=e.compTitle,o=e.category,s=e.options,u=void 0===s?{}:s,n.p=1,null!==o&&void 0!==o&&o.path){n.n=2;break}return r("notifications/error",{text:"Категория не выбрана"},{root:!0}),n.a(2,!1);case 2:return l=function(t){return String(t||"").replace(/\.[^.]+$/,"")},p=Q(l(a)||"Composition"),n.n=3,W(o.path,p);case 3:return f=n.v,d=f.dirPath,m=f.dirName,n.n=4,c.a.promises.mkdir(d,{recursive:!0});case 4:return h={destDir:d.replace(/\\/g,"/"),title:p,wantMov:!!u.mov,pngAtSeconds:Number(u.pngAtSeconds||0)},n.n=5,Object(et["b"])("AE_PackageActiveCompAtomic(".concat(JSON.stringify(h),")"));case 5:if(g=n.v,g.ok){n.n=6;break}return r("notifications/error",{text:"Ошибка упаковки (".concat(g.error||"unknown","): ").concat(g.errorDetail||"")},{root:!0}),n.a(2,!1);case 6:return n.n=7,r("manifest/upsertCategory",{composition:p,categoryPath:o.path},{root:!0});case 7:return n.n=8,r("categories/fetchCategories",null,{root:!0});case 8:return r("notifications/info",{text:'Композиция "'.concat(m,'" сохранена')},{root:!0}),n.a(2,!0);case 9:return n.p=9,b=n.v,r("notifications/error",{text:"Ошибка: ".concat(b.message)},{root:!0}),n.a(2,!1)}}),n,null,[[1,9]])})))()}}},ot=(n("a434"),{namespaced:!0,state:function(){return{items:[]}},mutations:{add:function(t,e){var n=e.type,r=e.text,a=e.silent,i=void 0!==a&&a,o={type:n,text:r,time:Date.now()};console[n]?console[n](o):console.log(o),i||t.items.push(o)},clear:function(t){t.items=[]},remove:function(t,e){t.items.splice(e,1)}},actions:{error:function(t,e){var n=t.commit,r=e.text,a=e.silent,i=void 0!==a&&a;n("add",{type:"error",text:r,silent:i})},warn:function(t,e){var n=t.commit,r=e.text,a=e.silent,i=void 0!==a&&a;n("add",{type:"warn",text:r,silent:i})},info:function(t,e){var n=t.commit,r=e.text,a=e.silent,i=void 0!==a&&a;n("add",{type:"info",text:r,silent:i})},clear:function(t){var e=t.commit;e("clear")},logOnly:function(t,e){var n=t.commit,r=e.type,a=e.text;n("add",{type:r,text:a,silent:!0})}},getters:{all:function(t){return t.items},last:function(t){return t.items[t.items.length-1]||null},infos:function(t){return t.items.filter((function(t){return"info"===t.type}))},errors:function(t){return t.items.filter((function(t){return"error"===t.type}))},warnings:function(t){return t.items.filter((function(t){return"warn"===t.type}))}}});r["a"].use(a["a"]);var st=new a["a"].Store({modules:{search:O,config:v,library:k,loading:x,manifest:H,categories:tt,compositions:it,notifications:ot}}),ct=function(){var t=this,e=t._self._c;return e("sp-theme",{attrs:{id:"app",color:t.appTheme,system:"spectrum",scale:"medium",dir:"ltr"}},[e("Panel",[e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("router-view")],1),t._v(" "),e("Menus",{attrs:{refresh:"",debug:""}}),t._v(" "),e("Toast")],1)],1)},ut=[];function lt(){var t=JSON.parse(window.__adobe_cep__.getHostEnvironment()).appSkinInfo.panelBackgroundColor.color.red;return t>50?"light":t>30?"dark":"darkest"}function pt(t){return window.getComputedStyle(document.documentElement).getPropertyValue("".concat(/^\-\-/.test(t)?t:"--"+t))}function ft(t,e){document.documentElement.style.setProperty("".concat(/^\-\-/.test(t)?t:"--"+t),e)}var dt=n("1a8c"),mt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"z-50 notifications"},t._l(t.notifications,(function(n,r){return e("sp-toast",{key:n.time,attrs:{size:"s",timeout:"3000",open:t.open,variant:t.mapTypeToVariant(n.type),"icon-label":n.type}},[t._v("\n            "+t._s(n.text)+"\n        ")])})),1)},ht=[],gt={name:"Toast",data:{open:!1},computed:Object(y["a"])(Object(y["a"])({},Object(a["c"])("notifications",["all"])),{},{notifications:function(){return this.open=!0,this.all}}),methods:Object(y["a"])(Object(y["a"])({},Object(a["d"])("notifications",["remove"])),{},{mapTypeToVariant:function(t){switch(t){case"error":return"negative";case"warn":return"warning";case"info":return"info";default:return"info"}}})},bt=gt,vt=(n("2a89"),n("2877")),yt=Object(vt["a"])(bt,mt,ht,!1,null,"2a04f676",null),_t=yt.exports,wt={name:"App",components:{Menus:dt["a"],Panel:dt["b"],Toast:_t},mounted:function(){var t=this;return Object(o["a"])(Object(i["a"])().m((function e(){return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.$store.dispatch("config/initConfig");case 1:return e.a(2)}}),e)})))()},methods:{getCSS:pt,setCSS:ft},watch:{appTheme:function(t){this.setCSS("--app-theme",t)}},computed:{appTheme:function(){return lt()},appThemeVersion:{get:function(){return this.$store.state.config.appThemeVersion},set:function(t){this.$store.commit("config/setAppThemeVersion",t)}}}},jt=wt,Ot=Object(vt["a"])(jt,ct,ut,!1,null,null,null),Ct=Ot.exports,kt=n("8c4f"),xt=function(){var t=this,e=t._self._c;return e("main",{staticClass:"flex flex-col justify-between h-full"},[e("div",{staticClass:"flex h-full gap-4 overflow-hidden"},[e("LibrarySidebar"),t._v(" "),e("LibraryContent")],1)])},St=[],Et=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sticky top-0 z-50",staticStyle:{"max-width":"170px"}},[e("div",{staticClass:"flex flex-col justify-between h-full"},[e("sp-sidenav",{staticClass:"w-full"},[t.getFilteredCategories.length?e("sp-sidenav-heading",{attrs:{label:t.$t("sidebar.title")}},t._l(t.getFilteredCategories,(function(n){return e("sp-sidenav-item",{key:n.name,attrs:{value:n.name,label:n.name},on:{click:function(e){return t.setCurrentCategory(n)}}},[e("sp-icon-folder",{attrs:{slot:"icon"},slot:"icon"})],1)})),1):t._e()],1),t._v(" "),e("sp-action-group",{attrs:{size:"s",vertical:""}},[e("sp-action-button",{attrs:{id:"create-category"}},[t._v("\n                "+t._s(t.$t("buttons.new_category"))+"\n            ")]),t._v(" "),e("sp-action-button",{attrs:{id:"create-composition",disabled:!t.canCreateComposition},on:{click:t.onNewCompositionClick}},[t._v("\n                "+t._s(t.$t("buttons.new_composition"))+"\n            ")])],1)],1),t._v(" "),e("DialogCategory"),t._v(" "),e("DialogComposition")],1)},Tt=[],$t=(n("712a"),function(){var t=this,e=t._self._c;return e("sp-overlay",{attrs:{trigger:"create-category@click"}},[e("sp-dialog-base",{staticClass:"h-full",attrs:{dismissable:"",underlay:""}},[e("sp-dialog",{attrs:{size:"s"}},[e("h2",{staticClass:"text-lg font-bold",attrs:{slot:"heading"},slot:"heading"},[t._v("\n                "+t._s(t.$t("buttons.new_category"))+"\n            ")]),t._v(" "),e("sp-textfield",{ref:"input",staticClass:"w-full",attrs:{id:t.id,type:"text",value:t.name,placeholder:t.$t("categories.name"),disabled:t.loading,invalid:!!t.localError,pattern:".*\\S.*",required:""},on:{input:function(e){t.name=e.target.value},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.trySave.apply(null,arguments)}}},[t.localError?e("sp-help-text",{attrs:{slot:"negative-help-text"},slot:"negative-help-text"},[t._v("\n                    "+t._s(t.localError)+"\n                ")]):t._e()],1),t._v(" "),e("sp-button-group",{attrs:{slot:"button",size:"s"},slot:"button"},[e("sp-button",{attrs:{onclick:"this.dispatchEvent(new Event('close', { bubbles: true, composed: true }));"}},[t._v("\n                    "+t._s(t.$t("buttons.cancel"))+"\n                ")]),t._v(" "),e("sp-button",{attrs:{disabled:!t.name,pending:t.loading},on:{click:t.trySave}},[t._v("\n                    "+t._s(t.loading?t.$t("buttons.saving"):t.$t("buttons.save"))+"\n                ")])],1)],1)],1)],1)}),Pt=[],Lt=(n("fb6a"),n("25f0"),{name:"DialogCategory",props:{id:{type:String,default:function(){return"cat-input-".concat(Math.random().toString(36).slice(2))}}},data:function(){return{name:"",localError:""}},computed:{loading:function(){return this.$store.getters["loading/isLoadingByKey"]("categories:create")}},methods:Object(y["a"])(Object(y["a"])({},Object(a["b"])("categories",["createCategory"])),{},{trySave:function(t){var e=this;return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(e.localError="",a=(null===(r=e.$refs.input)||void 0===r?void 0:r.focusElement)||e.$refs.input,a.checkValidity()){n.n=1;break}return e.localError=a.validationMessage,n.a(2);case 1:return e.$store.dispatch("loading/start","categories:create"),n.p=2,o=e.name.trim(),n.n=3,e.createCategory(o);case 3:e.name="",e.localError="",t.target.dispatchEvent(new Event("close",{bubbles:!0,composed:!0})),n.n=5;break;case 4:n.p=4,s=n.v,e.localError=String((null===s||void 0===s?void 0:s.message)||e.$t("errors.unknown"));case 5:return n.p=5,e.$store.dispatch("loading/stop","categories:create"),n.f(5);case 6:return n.a(2)}}),n,null,[[2,4,5,6]])})))()}})}),Dt=Lt,Mt=Object(vt["a"])(Dt,$t,Pt,!1,null,null,null),At=Mt.exports,Bt=function(){var t=this,e=t._self._c;return e("sp-overlay",{attrs:{trigger:"create-composition@click"}},[e("sp-dialog-base",{staticClass:"h-full",attrs:{dismissable:"",underlay:""}},[e("sp-dialog",{attrs:{size:"s"}},[e("h2",{staticClass:"text-lg font-bold",attrs:{slot:"heading"},slot:"heading"},[t._v("\n                "+t._s(t.$t("buttons.new_composition"))+"\n            ")]),t._v(" "),e("sp-field-label",{attrs:{for:"with-field-label"}},[t._v(t._s(t.$t("compositions.generate_formats")))]),t._v(" "),e("sp-field-group",{attrs:{horizontal:"",id:"formats"}},t._l(t.options,(function(n){return e("sp-checkbox",{key:n.value,attrs:{checked:n.checked,disabled:n.disabled||t.loading},on:{change:function(t){n.checked=t.target.checked}}},[t._v("\n                    "+t._s(n.label)+"\n                ")])})),1),t._v(" "),e("sp-textfield",{ref:"input",staticClass:"w-full mt-3",attrs:{id:t.id,type:"text",value:t.name,placeholder:t.$t("compositions.name"),disabled:t.loading,invalid:!!t.localError,pattern:".*\\S.*",required:""},on:{input:function(e){t.name=e.target.value},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.trySave.apply(null,arguments)}}},[t.localError?e("sp-help-text",{attrs:{slot:"negative-help-text"},slot:"negative-help-text"},[t._v("\n                    "+t._s(t.localError)+"\n                ")]):t._e()],1),t._v(" "),e("sp-button-group",{attrs:{slot:"button",size:"s"},slot:"button"},[e("sp-button",{attrs:{onclick:"this.dispatchEvent(new Event('close', { bubbles: true, composed: true }));"}},[t._v("\n                    "+t._s(t.$t("buttons.cancel"))+"\n                ")]),t._v(" "),e("sp-button",{attrs:{disabled:!t.name,pending:t.loading},on:{click:t.trySave}},[t._v("\n                    "+t._s(t.loading?t.$t("buttons.saving"):t.$t("buttons.save"))+"\n                ")])],1)],1)],1)],1)},Ft=[],Nt={name:"DialogComposition",props:{id:{type:String,default:function(){return"comp-input-".concat(Math.random().toString(36).slice(2))}}},data:function(){return{name:"",localError:"",options:{aep:{label:"AEP",value:"aep",checked:!0,disabled:!0},mov:{label:"MOV",value:"mov",checked:!1,disabled:!0},gif:{label:"GIF (preview)",value:"gif",checked:!1,disabled:!0}}}},computed:Object(y["a"])(Object(y["a"])({},Object(a["c"])("categories",["getCurrentCategory"])),{},{loading:function(){return this.$store.getters["loading/isLoadingByKey"]("compositions:create")}}),watch:{"options.gif.checked":function(t){t&&!this.options.mov.checked&&(this.options.mov.checked=!0)},"options.mov.checked":function(t){!t&&this.options.gif.checked&&(this.options.gif.checked=!1)}},methods:Object(y["a"])(Object(y["a"])({},Object(a["b"])("compositions",["saveComposition"])),{},{trySave:function(t){var e=this;return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o,s,c,u;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(e.localError="",a=(e.name||"").trim(),o=(null===(r=e.$refs.input)||void 0===r?void 0:r.focusElement)||e.$refs.input,o.checkValidity()){n.n=1;break}return e.localError=o.validationMessage,n.a(2);case 1:if(e.getCurrentCategory){n.n=2;break}return e.localError=e.$t("errors.category_not_selected")||"Категория не выбрана",n.a(2);case 2:return e.$store.dispatch("loading/start","compositions:create"),n.p=3,n.n=4,Object(et["b"])("AE_GetActiveCompName()");case 4:if(s=n.v,s){n.n=5;break}return e.localError=e.$t("compositions.error_no_compositions")||"В After Effects нет активной композиции",n.a(2);case 5:return n.n=6,e.saveComposition({compName:s,compTitle:a,category:e.getCurrentCategory,options:{mov:e.options.mov.checked,gif:e.options.gif.checked}});case 6:c=n.v,c&&t.target.dispatchEvent(new Event("close",{bubbles:!0,composed:!0})),n.n=8;break;case 7:n.p=7,u=n.v,e.localError=String((null===u||void 0===u?void 0:u.message)||e.$t("errors.unknown"));case 8:return n.p=8,e.$store.dispatch("loading/stop","compositions:create"),n.f(8);case 9:return n.a(2)}}),n,null,[[3,7,8,9]])})))()}})},qt=Nt,It=Object(vt["a"])(qt,Bt,Ft,!1,null,null,null),zt=It.exports,Rt={name:"SidebarComponent",components:{DialogCategory:At,DialogComposition:zt},data:function(){return{dialogComposition:!1}},computed:Object(y["a"])(Object(y["a"])({},Object(a["c"])("categories",["getFilteredCategories","getCurrentCategory"])),{},{currentCategory:{get:function(){return this.getCurrentCategory},set:function(t){this.setCurrentCategory(t)}},canCreateComposition:function(){return!!this.currentCategory}}),methods:Object(y["a"])(Object(y["a"])({},Object(a["d"])("categories",["setCurrentCategory"])),{},{onNewCompositionClick:function(t){var e=this;return Object(o["a"])(Object(i["a"])().m((function n(){return Object(i["a"])().w((function(n){while(1)switch(n.n){case 0:if(e.currentCategory){n.n=1;break}return n.a(2);case 1:t.target.dispatchEvent(new Event("open",{bubbles:!0,composed:!0}));case 2:return n.a(2)}}),n)})))()}})},Ut=Rt,Jt=Object(vt["a"])(Ut,Et,Tt,!1,null,null,null),Vt=Jt.exports,Ht=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col w-full gap-4 pr-3 mt-3"},[e("div",{staticClass:"flex gap-2"},[e("sp-action-menu",{attrs:{size:"s",disabled:""}},[e("sp-icon-settings",{attrs:{slot:"icon"},slot:"icon"}),t._v(" "),e("sp-menu-item",[t._v(" Deselect ")]),t._v(" "),e("sp-menu-item",[t._v(" Select inverse ")]),t._v(" "),e("sp-menu-item",[t._v(" Feather... ")]),t._v(" "),e("sp-menu-item",[t._v(" Select and mask... ")]),t._v(" "),e("sp-menu-divider"),t._v(" "),e("sp-menu-item",[t._v(" Save selection ")]),t._v(" "),e("sp-menu-item",{attrs:{disabled:""}},[t._v(" Make work path ")])],1),t._v(" "),e("sp-search",{staticClass:"w-full",attrs:{size:"s",value:t.query},on:{input:t.onSearch}})],1),t._v(" "),t.query||t.getCurrentCategory?e("div",{staticClass:"w-full h-full max-w-full pr-2 overflow-x-hidden overflow-y-auto"},[t.query&&0!==t.results.length?e("div",{staticClass:"grid grid-cols-12 gap-2"},t._l(t.results,(function(t,n){return e("CardComposition",{key:t.path,attrs:{composition:t,index:n}})})),1):t.query||0===t.compositions.length?t._e():e("div",{staticClass:"grid grid-cols-12 gap-2"},t._l(t.compositions,(function(t,n){return e("CardComposition",{key:t.path||t.name,attrs:{composition:t,index:n}})})),1),t._v(" "),t.query&&0===t.results.length?e("MessageEmpty",{attrs:{title:"".concat(t.query),description:"По запросу ничего не найдено"}}):t.query||0!==t.compositions.length?t._e():e("MessageEmpty",{attrs:{title:t.$t("illustratedMessage.category_empty_title"),description:t.$t("illustratedMessage.category_empty_description")}})],1):e("MessageEmpty"),t._v(" "),e("MadeBy")],1)},Kt=[],Yt=(n("cb29"),n("96de"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex items-center justify-between",staticStyle:{color:"var(--spectrum-accent-visual-color)"}},[e("span",[t._v("made by: "+t._s(t.author))]),t._v(" "),e("span",[t._v("version: "+t._s(t.version)+" ")])])}),Zt=[],Gt={name:"MadeBy",data:function(){return{author:"A&I ROMANOV's",version:"2.2.0"}}},Qt=Gt,Wt=Object(vt["a"])(Qt,Yt,Zt,!1,null,null,null),Xt=Wt.exports,te=function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-3"},[e("sp-card",{staticClass:"w-full",attrs:{variant:"gallery"}},[e("div",{attrs:{slot:"heading"},slot:"heading"},[e("HighlightText",{attrs:{text:t.composition.name,matches:t.composition.matches}})],1),t._v(" "),e("div",{attrs:{slot:"preview"},slot:"preview"},[t.url?e("img",{staticClass:"w-full max-w-full card-preview",attrs:{slot:"preview",alt:"",src:t.url},slot:"preview"}):e("sp-asset",{attrs:{variant:"file"}})],1),t._v(" "),e("div",{attrs:{slot:"actions"},slot:"actions"},[e("sp-action-group",{attrs:{size:"s",compact:""}},[t._l(t.composition.formats,(function(n,r){return e("sp-action-button",{key:n,attrs:{"aria-label":"".concat(t.composition.name," • ").concat(n),disabled:t.loading},on:{click:function(e){return t.importFormat(n,t.composition.filesPaths[r])}}},[e("span",[t._v(t._s(n))]),t._v(" "),t.instanceLoading[n]?e("sp-progress-circle",{attrs:{slot:"icon",size:"s",indeterminate:""},slot:"icon"}):t._e()],1)})),t._v(" "),e("sp-action-button",{attrs:{label:"Edit","hold-affordance":"",disabled:t.loading},on:{click:function(e){return t.openFolder("".concat(t.composition.path))}}},[e("sp-icon-folder-open-outline",{attrs:{slot:"icon"},slot:"icon"})],1)],2)],1)])],1)},ee=[],ne=n("ade3"),re=n("d4ec"),ae=n("bee2"),ie=(n("4ec9"),n("2b3d"),n("bf19"),n("9861"),n("88a7"),n("271a"),n("5494"),n("f8da")),oe=n.n(ie),se={".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".gif":"image/gif",".webp":"image/webp"},ce=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(re["a"])(this,t),this.limit=e,this.map=new Map}return Object(ae["a"])(t,[{key:"get",value:function(t){if(this.map.has(t)){var e=this.map.get(t);return this.map.delete(t),this.map.set(t,e),e}}},{key:"set",value:function(t,e){if(this.map.has(t)&&this.map.delete(t),this.map.set(t,e),this.map.size>this.limit){var n=this.map.keys(),r=Object(w["a"])(n,1),a=r[0];this.delete(a)}}},{key:"delete",value:function(t){var e=this.map.get(t);e&&URL.revokeObjectURL(e),this.map.delete(t)}},{key:"clear",value:function(){var t,e=Object(_["a"])(this.map);try{for(e.s();!(t=e.n()).done;){var n=Object(w["a"])(t.value,2),r=n[1];URL.revokeObjectURL(r)}}catch(a){e.e(a)}finally{e.f()}this.map.clear()}}])}(),ue=new ce(80);function le(t){return pe.apply(this,arguments)}function pe(){return pe=Object(o["a"])(Object(i["a"])().m((function t(e){var n,r,a,o;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:if(e){t.n=1;break}return t.a(2,"");case 1:if(n=ue.get(e),!n){t.n=2;break}return t.a(2,n);case 2:return t.n=3,oe.a.readFile(e);case 3:return r=t.v,a=se[l.a.extname(e).toLowerCase()]||"application/octet-stream",o=URL.createObjectURL(new Blob([r],{type:a})),ue.set(e,o),t.a(2,o)}}),t)}))),pe.apply(this,arguments)}function fe(t){ue.delete(t)}var de=function(){var t=this,e=t._self._c;return e("span",{domProps:{innerHTML:t._s(t.highlighted)}})},me=[],he={name:"HighlightText",props:{text:{type:String,required:!0},matches:{type:Array,default:function(){return[]}}},computed:{highlighted:function(){var t;if(null===(t=this.matches)||void 0===t||!t.length)return this.text;var e="",n=0,r=this.matches.find((function(t){return"name"===t.key}));if(!r)return this.text;var a,i=Object(_["a"])(r.indices);try{for(i.s();!(a=i.n()).done;){var o=Object(w["a"])(a.value,2),s=o[0],c=o[1];e+=this.text.slice(n,s),e+='<mark class="bg-yellow-300">'.concat(this.text.slice(s,c+1),"</mark>"),n=c+1}}catch(u){i.e(u)}finally{i.f()}return e+=this.text.slice(n),e}}},ge=he,be=Object(vt["a"])(ge,de,me,!1,null,null,null),ve=be.exports,ye=(n("ab1b"),{name:"CardComposition",props:{index:{type:Number,required:!0},composition:{type:Object,required:!0}},data:function(){return{url:"",instanceLoading:{}}},components:{HighlightText:ve},mounted:function(){this.observe()},beforeDestroy:function(){this.url&&(fe(this.composition.previewPath),this.url="")},computed:{loading:function(){return this.$store.getters["loading/isLoadingByKey"]("composition:format:import")}},methods:{observe:function(){var t=this,e=new IntersectionObserver(function(){var e=Object(o["a"])(Object(i["a"])().m((function e(n){var r,a,o,s;return Object(i["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:!1,r=Object(_["a"])(n),e.p=1,r.s();case 2:if((a=r.n()).done){e.n=7;break}if(o=a.value,!o.isIntersecting){e.n=5;break}if(!0,t.url||!t.composition.previewPath){e.n=4;break}return e.n=3,le(t.composition.previewPath);case 3:t.url=e.v;case 4:e.n=6;break;case 5:!1,t.url&&(fe(t.composition.previewPath),t.url="");case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,s=e.v,r.e(s);case 9:return e.p=9,r.f(),e.f(9);case 10:return e.a(2)}}),e,null,[[1,8,9,10]])})));return function(t){return e.apply(this,arguments)}}(),{root:null,threshold:.1});e.observe(this.$el),this._io=e},delay:function(t){return new Promise((function(e){return setTimeout(e,t)}))},importFormat:function(t,e){var n=this;return Object(o["a"])(Object(i["a"])().m((function r(){var a,o,s;return Object(i["a"])().w((function(r){while(1)switch(r.p=r.n){case 0:if(e){r.n=1;break}return r.a(2);case 1:return n.instanceLoading=Object(y["a"])(Object(y["a"])({},n.instanceLoading),{},Object(ne["a"])({},t,!0)),n.$store.dispatch("loading/start","composition:format:import"),r.p=2,a=e.replace(/\\/g,"/"),r.n=3,Object(et["b"])('AE_ImportFile("'.concat(a,'")'));case 3:r.n=5;break;case 4:return r.p=4,s=r.v,o=String(s).replace(/["\\]/g,"\\$&").replace(/\n/g,"\\n"),r.n=5,Object(et["b"])('alert("'.concat(o,'")'));case 5:return r.p=5,n.instanceLoading=Object(y["a"])(Object(y["a"])({},n.instanceLoading),{},Object(ne["a"])({},t,!1)),n.$store.dispatch("loading/stop","composition:format:import"),r.f(5);case 6:return r.a(2)}}),r,null,[[2,4,5,6]])})))()},openFolder:function(t){var e=this;return Object(o["a"])(Object(i["a"])().m((function n(){var r,a,o;return Object(i["a"])().w((function(n){while(1)switch(n.p=n.n){case 0:if(t){n.n=1;break}return n.a(2);case 1:return n.p=1,r=t.replace(/\\/g,"/"),n.n=2,Object(et["b"])('AE_OpenFolder("'.concat(r,'")'));case 2:a=n.v,"ok"!==a&&e.$store.dispatch("notifications/error",{text:e.$t("errors.cannot_open_folder")},{root:!0}),n.n=4;break;case 3:n.p=3,o=n.v,e.$store.dispatch("notifications/error",{text:e.$t("errors.error_open_folder")+o.message},{root:!0});case 4:return n.a(2)}}),n,null,[[1,3]])})))()}}}),_e=ye,we=Object(vt["a"])(_e,te,ee,!1,null,null,null),je=we.exports,Oe=(n("a4d3"),n("e01a"),function(){var t=this,e=t._self._c;return e("sp-illustrated-message",{attrs:{heading:t.title}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 150 103",width:"150",height:"103"}},[e("path",{attrs:{d:"M133.7,8.5h-118c-1.9,0-3.5,1.6-3.5,3.5v27c0,0.8,0.7,1.5,1.5,1.5s1.5-0.7,1.5-1.5V23.5h119V92c0,0.3-0.2,0.5-0.5,0.5h-118c-0.3,0-0.5-0.2-0.5-0.5V69c0-0.8-0.7-1.5-1.5-1.5s-1.5,0.7-1.5,1.5v23c0,1.9,1.6,3.5,3.5,3.5h118c1.9,0,3.5-1.6,3.5-3.5V12C137.2,10.1,135.6,8.5,133.7,8.5z M15.2,21.5V12c0-0.3,0.2-0.5,0.5-0.5h118c0.3,0,0.5,0.2,0.5,0.5v9.5H15.2z M32.6,16.5c0,0.6-0.4,1-1,1h-10c-0.6,0-1-0.4-1-1s0.4-1,1-1h10C32.2,15.5,32.6,15.9,32.6,16.5z M13.6,56.1l-8.6,8.5C4.8,65,4.4,65.1,4,65.1c-0.4,0-0.8-0.1-1.1-0.4c-0.6-0.6-0.6-1.5,0-2.1l8.6-8.5l-8.6-8.5c-0.6-0.6-0.6-1.5,0-2.1c0.6-0.6,1.5-0.6,2.1,0l8.6,8.5l8.6-8.5c0.6-0.6,1.5-0.6,2.1,0c0.6,0.6,0.6,1.5,0,2.1L15.8,54l8.6,8.5c0.6,0.6,0.6,1.5,0,2.1c-0.3,0.3-0.7,0.4-1.1,0.4c-0.4,0-0.8-0.1-1.1-0.4L13.6,56.1z"}})]),t._v(" "),e("p",{attrs:{slot:"description"},slot:"description"},[t._v("\n       "+t._s(t.description)+"\n    ")])])}),Ce=[],ke={name:"MessageEmpty",props:{title:{type:String,default:function(){return this.$t("illustratedMessage.category_not_selected_title")}},description:{type:String,default:function(){return this.$t("illustratedMessage.category_not_selected_description")}}}},xe=ke,Se=(n("a9b6"),Object(vt["a"])(xe,Oe,Ce,!1,null,null,null)),Ee=Se.exports,Te={name:"ContentComponent",components:{CardComposition:je,MessageEmpty:Ee,MadeBy:Xt},data:function(){return{loadingItem:[]}},computed:Object(y["a"])(Object(y["a"])(Object(y["a"])({},Object(a["c"])("categories",["getCurrentCategory"])),Object(a["c"])("search",["results","query"])),{},{compositions:function(){var t;return(null===(t=this.getCurrentCategory)||void 0===t?void 0:t.compositions)||[]}}),mounted:function(){this.$store.dispatch("search/init")},watch:{compositions:{immediate:!0,handler:function(t){this.loadingItem=Array((t||[]).length).fill(!1)}}},methods:{onSearch:function(t){this.$store.dispatch("search/run",t.target.value)}}},$e=Te,Pe=Object(vt["a"])($e,Ht,Kt,!1,null,null,null),Le=Pe.exports,De={name:"LibraryPage",components:{LibrarySidebar:Vt,LibraryContent:Le}},Me=De,Ae=Object(vt["a"])(Me,xt,St,!1,null,null,null),Be=Ae.exports,Fe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col items-center justify-center max-w-lg gap-10 p-4 mx-auto"},[e("h2",{staticClass:"w-full m-0 text-2xl text-center"},[t._v("\n        "+t._s(t.title)+"\n    ")]),t._v(" "),e("div",{staticClass:"flex flex-col w-full gap-4"},[e("sp-textfield",{ref:"file",staticClass:"w-full",attrs:{required:"",type:"text",value:t.selectedPath,label:t.$t("settings.folder_select_label"),placeholder:t.$t("settings.folder_select_placeholder")},on:{click:t.openDialog}},[t.statusMessage?e("sp-help-text",{attrs:{slot:"help-text"},slot:"help-text"},[t._v("\n                "+t._s(t.statusMessage)+"\n            ")]):t._e(),t._v(" "),t.statusMessage&&"invalid"===t.libraryType?e("sp-help-text",{attrs:{slot:"negative-help-text"},slot:"negative-help-text"},[t._v("\n                "+t._s(t.statusMessage)+"\n            ")]):t._e()],1),t._v(" "),e("sp-picker",{staticClass:"w-full",attrs:{disabled:"",value:t.locale},on:{change:function(e){t.locale=e.target.value}}},[e("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(t.$t("settings.select_language")))]),t._v(" "),e("sp-menu-item",{attrs:{value:"ru",default:""}},[t._v("Русский")]),t._v(" "),e("sp-menu-item",{attrs:{value:"en",disabled:""}},[t._v("English")])],1)],1),t._v(" "),e("sp-button",{attrs:{disabled:!t.selectedPath||t.isBad},on:{click:t.confirmPath}},[t._v("\n        "+t._s(t.$t("buttons.save"))+"\n    ")])],1)},Ne=[],qe={name:"SettingsPage",data:function(){return{selectedPath:null}},computed:Object(y["a"])(Object(y["a"])(Object(y["a"])({},Object(a["e"])("config",["libraryType","locale"])),Object(a["e"])("categories",["error"])),{},{title:function(){return this.$route.query.first?this.$t("settings.first_title"):this.$t("settings.title")},libraryTypeMessage:function(){switch(this.libraryType){case"our":return this.$t("settings.folder_our");case"new":return this.$t("settings.folder_new");case"invalid":return this.$t("settings.folder_invalid");case"error":return this.$t("settings.folder_error");default:return null}},isBad:function(){return"invalid"===this.libraryType||"error"===this.libraryType||!!this.error},statusMessage:function(){return this.error||this.libraryTypeMessage},locale:{get:function(){return this.$store.state.config.locale},set:function(t){this.$store.commit("config/setLocale",t)}}}),watch:{locale:function(t){this.setLocale(t),this.$i18n.locale=t}},methods:Object(y["a"])(Object(y["a"])(Object(y["a"])({},Object(a["b"])("library",["initLibrary","detectLibraryType"])),Object(a["d"])("config",["setLibraryType","setLocale"])),{},{openDialog:function(){var t=this,e=window.cep.fs.showOpenDialog(!1,!0,this.$t("settings.folder_select"));0===e.err&&e.data&&e.data.length>0&&(this.selectedPath=e.data[0],this.detectLibraryType(this.selectedPath).then((function(e){return t.setLibraryType(e)})))},confirmPath:function(){var t=this;return Object(o["a"])(Object(i["a"])().m((function e(){var n;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:if(t.selectedPath&&!t.isBad){e.n=1;break}return e.a(2);case 1:return e.n=2,t.initLibrary(t.selectedPath);case 2:n=e.v,n&&t.$router.push({name:"Library"});case 3:return e.a(2)}}),e)})))()}})},Ie=qe,ze=Object(vt["a"])(Ie,Fe,Ne,!1,null,null,null),Re=ze.exports;r["a"].use(kt["a"]);var Ue=new kt["a"]({routes:[{path:"/",name:"Library",component:Be},{path:"/settings",name:"Settings",component:Re}]});Ue.beforeEach(function(){var t=Object(o["a"])(Object(i["a"])().m((function t(e,n,r){return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:if(st.state.config.pathDirectory){t.n=1;break}return t.n=1,st.dispatch("config/initConfig");case 1:if(st.state.config.pathDirectory||"Settings"===e.name){t.n=2;break}return t.a(2,r({name:"Settings",query:{first:1}}));case 2:if(!st.state.config.pathDirectory||"Settings"!==e.name||null!=n.name){t.n=3;break}return t.a(2,r({name:"Home"}));case 3:r();case 4:return t.a(2)}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}());var Je=Ue,Ve=n("a925"),He=(n("d940"),n("7704")),Ke=n("edd4");n("f78f"),n("8e1d"),n("0487"),n("f0d1"),n("ec84"),n("e2607"),n("9baa");r["a"].config.productionTip=!1,r["a"].config.devtools=!1,r["a"].use(Ve["a"]);var Ye=new Ve["a"]({locale:"ru",fallbackLocale:"en",messages:{ru:He,en:Ke}});new r["a"]({store:st,router:Je,i18n:Ye,render:function(t){return t(Ct)}}).$mount("#app")},7704:function(t){t.exports=JSON.parse('{"settings":{"title":"Настройки","first_title":"Предварительная настройка","select_language":"Выберите язык","folder_select":"Выберите папку","folder_select_label":"Корневая папка с проектами","folder_select_placeholder":"Укажите папку с проектами","folder_our":"Будет использована готовая библиотека EZImport","folder_existing":"Используется готовая библиотека с композициями (.aep)","folder_new":"Будет создана новая структура","folder_error":"Ошибка при определении папки","folder_invalid":"Данная папка не подходит для библиотеки EZImport"},"sidebar":{"title":"Категории"},"content":{"title":"Композиции"},"illustratedMessage":{"category_not_selected_title":"Категория не выбрана","category_not_selected_description":"Выберите категорию для просмотра композиций","category_empty_title":"Категория пуста","category_empty_description":"Добавьте композиции в выбранную категорию"},"categories":{"empty":"Пока что пусто","name":"Название категории","error_empty":"Имя не может быть пустым","error_exists":"Категория с таким именем уже существует","error_invalid":"Имя содержит недопустимые символы"},"compositions":{"name":"Название композиции","generate_formats":"Форматы к сохранению","error_empty":"Имя не может быть пустым","error_exists":"Композиция с таким именем уже существует","error_invalid":"Имя содержит недопустимые символы","error_no_compositions":"Вы не выбрали ни одной композиции"},"buttons":{"save":"Сохранить","cancel":"Отмена","saving":"Сохранение...","new_category":"Добавить категорию","new_composition":"Добавить композицию"},"errors":{"cannot_open_folder":"Не удалось открыть папку","error_open_folder":"Не удалось открыть папку"}}')},"9b0f":function(t,e){t.exports=require("fs")},a32b:function(t,e){t.exports=require("path")},a9b6:function(t,e,n){"use strict";n("d12b")},c02e:function(t,e,n){},d12b:function(t,e,n){},d940:function(t,e,n){},edd4:function(t){t.exports=JSON.parse('{"settings":{"title":"Settings","first_title":"Preliminary setup","select_language":"Select language","folder_select":"Select folder","folder_select_label":"Root folder with projects","folder_select_placeholder":"Enter folder with projects","folder_our":"EZImport library found (manifest.json)","folder_existing":"Ready library with compositions (.aep) is used","folder_new":"New structure will be created","folder_error":"Error while determining folder"},"buttons":{"save":"Save"}}')},f8da:function(t,e){t.exports=require("fs/promises")}});
//# sourceMappingURL=app.446a70bd.js.map